<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="msapplication-tap-highlight" content="no">
  <title>Sofa Control</title>

  <link rel="stylesheet" href="/bower_components/chocolatechip-ui/chui/chui.ios-3.0.2.css">
  <script src="/bower_components/chocolatechip-ui/chui/chocolatechip-3.0.2.js"></script>
  <script src="/bower_components/chocolatechip-ui/chui/chui-3.0.2.js"></script>

  <link rel="stylesheet" href="/bower_components/font-awesome/css/font-awesome.css">
  <!--[if IE 7]>
    <link rel="stylesheet" href="/bower_components/font-awesome/css/font-awesome-ie7.css">
  <![endif]-->

  <script src="/bower_components/jquery/jquery.min.js"></script>
  <script src="/bower_components/angular/angular.min.js"></script>
  <style>
    article > section, .slide-out > section {
      height: auto;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<script>
$(function() {
  (function(chui) {
    chui.UISlideout();
    $('.slide-out > section').append('\
      <h2>Services</h2>\
      <ul class="list mainnav">\
        <li data-show-article="sabnzbd">\
          <h3><i class="icon-cloud"></i> SABnzbd</h3>\
        </li>\
        <li data-show-article="sickbeard">\
          <h3><i class="icon-cloud"></i> Sick Beard</h3>\
        </li>\
        <li data-show-article="couchpotato">\
          <h3><i class="icon-cloud"></i> CouchPotato</h3>\
        </li>\
        <li data-show-article="settings">\
          <h3><i class="icon-cogs"></i> Settings</h3>\
        </li>\
      </ul>');

    //$('.segmented').UIPanelToggle('#toggle-panels',function(){$.noop;});
    if (chui.isiOS6) $('body').addClass('isiOS6');
    $('.tabbar-panel').addClass('hidden');
    $('.tabbar a.button').on('singletap', function(e) {
      $('.tabbar-panel:not(".hidden")').addClass('hidden');

      var id = $(this).attr('data-panel');
      var article = $(this).attr('data-article');
      var init = $(this).attr('data-init');

      $(id).removeClass('hidden')
      if(typeof init === "string") {
        angular.element(document.getElementById(article)).scope()[init]()
      }
    });
    $('.mainnav li').on('singletap', function(e) {
      var article = $(this).attr('data-show-article');
      angular.element(document.getElementById(article)).scope().init();
    });
    $('.mainnav li:first').trigger('singletap');
  })(window.$chocolatechip);
});
</script>
<body ng-app="sofaControlApp" class="hasTabBar">
  <!-- SABnzbd -->
  <div class="tabbar" ng-show="state == 'sabnzbd'">
    <a class="button" data-panel="#queue" data-article="sabnzbd">
      <span class="icon"></span> <label>Queue</label>
    </a>
    <a class="button" data-panel="#search" data-article="sabnzbd">
      <span class="icon"></span> <label>Search</label>
    </a>
    <a class="button" data-panel="#history" data-article="sabnzbd" data-init="getHistory">
      <span class="icon"></span> <label>History</label>
    </a>
    <a class="button" data-panel="#stats" data-article="sabnzbd">
      <span class="icon"></span> <label>Stats</label>
    </a>
  </div>

  <!-- Sick Beard -->
  <div class="tabbar" ng-show="state == 'sickbeard'">
    <a class="button" data-panel="#sb_shows" data-article="sickbeard" data-init="getShows">
      <span class="icon"></span> <label>Shows</label>
    </a>
    <a class="button" data-panel="#sb_search" data-article="sickbeard">
      <span class="icon"></span> <label>Add show</label>
    </a>
    <a class="button" data-panel="#sb_history" data-article="sickbeard" data-init="getHistory">
      <span class="icon"></span> <label>History</label>
    </a>
    <a class="button" data-panel="#sb_stats" data-article="sickbeard" data-init="getStats">
      <span class="icon"></span> <label>Stats</label>
    </a>
  </div>

  <!-- CouchPotato -->
  <div class="tabbar" ng-show="state == 'couchpotato'">
    <a class="button" data-panel="#queue" data-article="couchpotato">
      <span class="icon"></span> <label>couchpotato</label>
    </a>
  </div>

  <nav>
    <h1>SABnzbd</h1>
  </nav>
  <article id='sabnzbd' ng-controller="SabnzbCtrl">
    <section>
      <div id="queue" class="tabbar-panel">
        <h2>Queue <small>({{queue.length}} items)</small></h2>
        <ul class='list' ng-show="queue.length > 0">
          <li class='comp' ng-repeat="item in queue">
            <div>
              <h3>{{item.filename}}</h3>
              <h4>{{item.mbleft}} / {{item.mb}} MB</h4>
            </div>
            <aside>
              <h4>{{item.timeleft}}</h4>
              <span class='nav'></span>
            </aside>
          </li>
        </ul>
      </div>

      <div id="search" class="tabbar-panel">
        <h2>Search</h2>
        <form ng-submit="search(query)">
          <ul ui-implements='form' class='list'>
             <li class='comp' data-goto>
              <div>
                <label for='query'>Search query:</label>
              </div>
              <aside>
                <input id="query" type="text" ng-model="query" autocapitalize="off" autocorrect="off" required>
              </aside>
             </li>
          </ul>
        </form>

        <ul class='list' ng-show="searchResult.entries.length > 0">
          <li class='comp' ng-repeat="entry in searchResult.entries" ng-click="download(entry)">
            <div>
              <h3>{{entry.title}}</h3>
              <h4>{{entry.contentSnippet}}</h4>
            </div>
            <aside>
              <span class='nav'></span>
            </aside>
          </li>
        </ul>
      </div>

      <div id="history" class="tabbar-panel">
        <h2>History</h2>
        <ul class='list' ng-show="history.length > 0">
          <li class='comp' ng-repeat="item in history">
            <div>
              <h3>{{item.name}}</h3>
              <h4>Finished in: {{secondsToTime(item.download_time)}}</h4>
            </div>
            <aside>
              <h4>{{item.status}}</h4>
              <span class='nav'></span>
            </aside>
          </li>
        </ul>
      </div>

      <div id="stats" class="tabbar-panel">
        <h2>Stats</h2>

        <ul class='list'>
          <li class='switched'>
            <h3>Status</h3>
            <h4>{{stats.status}}</h4>
          </li>
          <li class='switched'>
            <h3>Download speed</h3>
            <h4>{{stats.kbpersec}}</h4>
          </li>
          <li class='switched'>
            <h3>Time left</h3>
            <h4>{{stats.timeleft}}</h4>
          </li>
          <li class='switched'>
            <h3>Disk1</h3>
            <h4>{{stats.diskspace1}} GB/ {{stats.diskspacetotal1}} GB</h4>
          </li>
          <li class='switched'>
            <h3>Disk2</h3>
            <h4>{{stats.diskspace2}} GB/ {{stats.diskspacetotal2}} GB</h4>
          </li>
          <li class='switched'>
            <h3>Uptime</h3>
            <h4>{{stats.uptime}}</h4>
          </li>
          <li class='switched'>
            <h3>Version</h3>
            <h4>{{stats.version}}</h4>
          </li>
        </ul>
      </div>
    </section>
  </article>

  <nav>
    <h1>Sick Beard</h1>
  </nav>
  <article id='sickbeard' ng-controller="SickBeardCtrl">
    <section>
      <div id="sb_shows" class="tabbar-panel">
        <h2>Continuing</h2>
        <ul class='list' ng-show="shows.length > 0">
          <li class='comp' ng-repeat="item in shows | orderBy:'show_name' | filter:statusContinuing()">
            <aside>
              <img ng-src="{{getBanner(item)}}" height="80px" onerror="this.src='http://jmundorf.edublogs.org/files/2010/09/question-mark.jpeg'" />
            </aside>
            <div>
              <!--  -->
              <h3>{{item.show_name}}</h3>
              <h4>{{item.network}} - {{item.quality}}</h4>
            </div>
            <aside>
              <h4>{{item.next_ep_airdate}}</h4>
              <span class='nav'></span>
            </aside>
          </li>
        </ul>

        <h2>Other</h2>
        <ul class='list' ng-show="shows.length > 0">
          <li class='comp' ng-repeat="item in shows | orderBy:'show_name' | filter:statusNotContinuing()">
            <aside>
              <img ng-src="{{getBanner(item)}}" height="80px" onerror="this.src='http://jmundorf.edublogs.org/files/2010/09/question-mark.jpeg'" />
            </aside>
            <div>
              <h3>{{item.show_name}}</h3>
              <h4>{{item.network}} - {{item.quality}}</h4>
            </div>
            <aside>
              <h4>{{item.status}}</h4>
              <span class='nav'></span>
            </aside>
          </li>
        </ul>
      </div>

      <div id="sb_search" class="tabbar-panel">
        <h2>Search</h2>
        <form ng-submit="search(query)">
          <ul ui-implements='form' class='list'>
             <li class='comp' data-goto>
              <div>
                <label for='query'>Search query:</label>
              </div>
              <aside>
                <input id="query" type="text" ng-model="query" autocapitalize="off" autocorrect="off" required>
              </aside>
             </li>
          </ul>
        </form>

        <div ng-show="searchResult.results.length > 0">
          <h2>Found ({{searchResult.results.length}}) results</h2>
          <ul class='list'>
            <li class='comp' ng-repeat="entry in searchResult.results" ng-click="addShow(entry)">
              <aside>
                <img ng-src="{{getBanner(entry)}}" height="80px" onerror="this.src='http://jmundorf.edublogs.org/files/2010/09/question-mark.jpeg'" />
              </aside>
              <div>
                <h3>{{entry.name}}</h3>
                <h4>{{entry.first_aired}}</h4>
              </div>
              <aside>
                <span class='nav'></span>
              </aside>
            </li>
          </ul>
        </div>
      </div>

      <div id="sb_history" class="tabbar-panel">
        <h2>History</h2>

        <ul class='list' ng-show="history.length > 0">
          <li class='comp' ng-repeat="item in history">
            <aside>
              <img ng-src="{{getBanner(item)}}" height="80px" onerror="this.src='http://jmundorf.edublogs.org/files/2010/09/question-mark.jpeg'" />
            </aside>
            <div>
              <h3>{{item.show_name}} Season: {{item.season}} Episode: {{item.episode}}</h3>
              <h4>{{item.provider}} {{item.quality}}</h4>
            </div>
            <aside>
              <h4>{{item.status}}</h4>
              <span class='nav'></span>
            </aside>
          </li>
        </ul>
      </div>

      <div id="sb_stats" class="tabbar-panel">
        <h2>Stats</h2>

        <ul class='list'>
          <li class='switched'>
            <h3>Episodes downloaded</h3>
            <h4>{{stats.ep_downloaded}}</h4>
          </li>
          <li class='switched'>
            <h3>Total episodes</h3>
            <h4>{{stats.ep_total}}</h4>
          </li>
          <li class='switched'>
            <h3>Shows active</h3>
            <h4>{{stats.shows_active}}</h4>
          </li>
          <li class='switched'>
            <h3>Total shows</h3>
            <h4>{{stats.shows_total}}</h4>
          </li>
        </ul>

      </div>
    </section>
  </article>

  <nav>
    <h1>CouchPotato</h1>
  </nav>
  <article id='couchpotato' ng-controller="CouchPotatoCtrl">
    <section>
      <h2>couchpotato</h2>
    </section>
  </article>

  <nav>
    <h1>Settings</h1>
  </nav>
  <article id='settings'>
    <section>
      <h2>settings</h2>
    </section>
  </article>

  <!-- APP -->
  <script src="/assets/javascripts/sofa-control.js"></script>
  <!-- CONFIG -->
  <script src="/config.js"></script>
  <!-- DIRECTIVES -->
  <!-- SERVICES -->
  <script src="/assets/javascripts/services/sabnzbd.js"></script>
  <script src="/assets/javascripts/services/sickbeard.js"></script>
  <script src="/assets/javascripts/services/couchpotato.js"></script>
  <!-- SERVICES: NZB Providers -->
  <script src="/assets/javascripts/services/nzb-providers/nzbindex.js"></script>
  <script src="/assets/javascripts/services/nzb-providers/nzbclub.js"></script>
  <!-- CONTROLLERS -->
  <script src="/assets/javascripts/controllers/sabnzbd_controller.js"></script>
  <script src="/assets/javascripts/controllers/sickbeard_controller.js"></script>
  <script src="/assets/javascripts/controllers/couchpotato_controller.js"></script>
</body>
</html>
